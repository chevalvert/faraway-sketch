{"version":3,"sources":["webpack:///webpack/bootstrap 80d35918725f232c785b","webpack:///./node_modules/@babel/runtime/helpers/slicedToArray.js","webpack:///./node_modules/@babel/runtime/helpers/toConsumableArray.js","webpack:///./node_modules/@babel/runtime/helpers/classCallCheck.js","webpack:///./node_modules/@babel/runtime/helpers/createClass.js","webpack:///./node_modules/missing-math/dist/missing-math.m.js","webpack:///./src/index.js","webpack:///./node_modules/hotkeys-js/dist/hotkeys.esm.js","webpack:///./node_modules/@internet/raf/lib/index.js","webpack:///./node_modules/@internet/raf/lib/RafTimer.js","webpack:///./node_modules/@internet/raf/lib/fpsLimiter.js","webpack:///./node_modules/@internet/raf/lib/raf.js","webpack:///(webpack)/buildin/global.js","webpack:///./src/abstractions/Scene.js","webpack:///./node_modules/@babel/runtime/helpers/construct.js","webpack:///./node_modules/@babel/runtime/helpers/setPrototypeOf.js","webpack:///./node_modules/@babel/runtime/helpers/arrayWithoutHoles.js","webpack:///./node_modules/@babel/runtime/helpers/iterableToArray.js","webpack:///./node_modules/@babel/runtime/helpers/nonIterableSpread.js","webpack:///./node_modules/@babel/runtime/helpers/arrayWithHoles.js","webpack:///./node_modules/@babel/runtime/helpers/iterableToArrayLimit.js","webpack:///./node_modules/@babel/runtime/helpers/nonIterableRest.js","webpack:///./src/abstractions/Phare.js","webpack:///./node_modules/segseg/index.js","webpack:///./node_modules/segseg/segpoint.js","webpack:///./src/utils/distance.js","webpack:///./src/utils/simulate-falloff.js","webpack:///./src/abstractions/BoundingBox.js","webpack:///./src/points.csv","webpack:///./src/index.scss?f84c"],"names":["window","addEventListener","document","getElementById","remove","store","debug","scene","color","padding","phare","displayLights","duration","awake","base","radius","led","length","arm","offset","thickness","canvas","querySelector","Scene","points","filter","x","isNaN","map","y","raf","add","dt","update","error","console","stop","hotkeys","clear","once","handleResize","bind","handleClick","props","ctx","getContext","bbox","BoundingBox","phares","Phare","push","screenToWorld","dpi","width","innerWidth","height","innerHeight","style","scale","Math","min","xmin","ymin","e","position","offsetX","offsetY","activeIndex","findIndex","isUnder","shiftKey","splice","trigger","clearRect","save","translate","forEach","candidate","hit","render","debugGeometry","restore","alpha","random","state","direction","sign","i","randomInt","sound","Audio","seed","realWorldTarget","dist","stateTime","brake","J","K1","pt","t","step","degrees","force","play","currentTime","intersect","body","sensor","lineCap","rotate","radians","fillStyle","beginPath","arc","PI","fill","light","computeLight","a","b","fallOff","intensity","density","rgba","R","G","B","strokeStyle","lineWidth","moveTo","lerp","bounds","lineTo","stroke","sin","initialIntensity","initialDensity","max","passes","clamp","t1","t2","_state","s","cos","x1","y1","x2","y2","dx","dy","sqrt","n","Number","POSITIVE_INFINITY","xmax","NEGATIVE_INFINITY","ymax","abs"],"mappings":"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AAvD;AAAsE,GAApF,CAAP;AACA0B,qEAAO,CAAC,GAAD,EAAM;AAAA,WAAMrC,MAAM,CAACO,KAAP,CAAa+B,KAAb,EAAN;AAAA,GAAN,CAAP;AACD,CAnDD,EAmDG;AAAEC,MAAI,EAAE;AAAR,CAnDH,E;;;;;;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,+GAA+G;;AAE/G;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,KAAK;AACL;AACA,CAAC;;;AAGD;AACA;;AAEA,iBAAiB,iBAAiB;AAClC;AACA;;AAEA;AACA,CAAC;;;AAGD;AACA;AACA,+BAA+B;;AAE/B,4BAA4B;;AAE5B,mCAAmC;;AAEnC,QAAQ,YAAY;AACpB;AACA;AACA;AACA;;AAEA;AACA,CAAC;;;AAGD;AACA;AACA;AACA;;AAEA,iBAAiB,iBAAiB;AAClC;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;;AAEnB,eAAe,QAAQ;AACvB;AACA;;AAEA,mBAAmB;;AAEnB,mBAAmB;;AAEnB,6BAA6B;AAC7B;;AAEA;AACA;AACA,EAAE;;;AAGF;AACA;AACA,CAAC;;;AAGD;AACA;AACA,CAAC;;;AAGD;AACA;AACA,CAAC;AACD;;;AAGA;AACA;AACA;AACA,kBAAkB;;AAElB;AACA;AACA;;AAEA;AACA,CAAC;;;AAGD;AACA;AACA,4BAA4B;AAC5B;;AAEA;AACA,CAAC;;;AAGD;AACA;AACA,QAAQ;;AAER;;AAEA;AACA;AACA;;AAEA,iBAAiB,qBAAqB;AACtC,+DAA+D;AAC/D;AACA;AACA,GAAG;;;AAGH;AACA,CAAC;;;AAGD;AACA;;AAEA,iCAAiC;;;AAGjC;AACA;AACA,GAAG;;;AAGH;AACA;AACA,GAAG;;;AAGH;;AAEA;AACA,uBAAuB;;AAEvB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH,+BAA+B,2BAA2B,GAAG,0CAA0C;AACvG;AACA;AACA,KAAK;AACL,GAAG;AACH,4BAA4B,mCAAmC;AAC/D;AACA,GAAG;AACH,0FAA0F,aAAa;AACvG;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,CAAC;;;AAGD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC;;AAEpC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,KAAK;AACL,GAAG;AACH,EAAE;;;AAGF;AACA,qBAAqB;;AAErB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;;AAGL;AACA;AACA,yDAAyD;AACzD;AACA;AACA;AACA;AACA;AACA,CAAC;;;AAGD;AACA;AACA,2DAA2D;;AAE3D,gDAAgD;AAChD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA,sBAAsB;;AAEtB;AACA;AACA;;AAEA;AACA,GAAG;;;AAGH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,GAAG;;;AAGH,yBAAyB;;AAEzB;AACA,mBAAmB,qBAAqB;AACxC;AACA;AACA;AACA;AACA,GAAG;;;AAGH;;AAEA,kBAAkB,4BAA4B;AAC9C;AACA;AACA;AACA;AACA;AACA,kCAAkC;;AAElC,uBAAuB,wBAAwB;AAC/C;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;AAGD;AACA;AACA;;AAEA;AACA;AACA,0BAA0B;;AAE1B;AACA,oBAAoB;;AAEpB,yBAAyB;;AAEzB;AACA;AACA;AACA,qBAAqB;;AAErB;AACA;AACA;;AAEA;AACA,2CAA2C;;AAE3C,iDAAiD;;AAEjD,2CAA2C;;AAE3C,+DAA+D;;AAE/D,wEAAwE;AACxE;;AAEA,iDAAiD;;AAEjD,QAAQ,iBAAiB;AACzB,kCAAkC;;AAElC,cAAc;;AAEd,uDAAuD;;AAEvD;AACA,wCAAwC;AACxC;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;;;AAGH;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEe,gEAAO,EAAC;;;;;;;;AC3iBvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAoC;AACI;AACd;;AAEU;AACrB,iHAAG;;;;;;;;ACLN;;AAEZ;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,WAAW,QAAQ;AACnB;AACA;AACA,WAAW,gBAAgB;AAC3B;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,oDAAoD;;AAEpD;AACA;AACA;AACA,kCAAkC;;AAElC;AACA;;AAEA;AACA;AACA;AACA,WAAW,SAAS;AACpB,WAAW,OAAO;AAClB;AACA;AACA,6DAA6D;AAC7D;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,QAAQ;AACnB;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEe,kFAAQ;;;;;;;;AC3GX;;AAEZ;AACA;AACA,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,YAAY,SAAS;AACrB;AACA,WAAW,kBAAkB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEe,oFAAU;;;;;;;;AClCzB,8CAAY;;AAEZ;AACA;AACA;AACA,UAAU;AACV;AACA,WAAW,MAAM;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,6BAA6B;AAC5C,eAAe,uBAAuB;AACtC,eAAe,4BAA4B;AAC3C,GAAG;AACH,eAAe,uBAAuB;AACtC;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,S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","file":"80d35918725f232c785b.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/faraway-sketch/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 80d35918725f232c785b","var arrayWithHoles = require(\"./arrayWithHoles\");\n\nvar iterableToArrayLimit = require(\"./iterableToArrayLimit\");\n\nvar nonIterableRest = require(\"./nonIterableRest\");\n\nfunction _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || nonIterableRest();\n}\n\nmodule.exports = _slicedToArray;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/@babel/runtime/helpers/slicedToArray.js\n// module id = 0\n// module chunks = 0","var arrayWithoutHoles = require(\"./arrayWithoutHoles\");\n\nvar iterableToArray = require(\"./iterableToArray\");\n\nvar nonIterableSpread = require(\"./nonIterableSpread\");\n\nfunction _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || nonIterableSpread();\n}\n\nmodule.exports = _toConsumableArray;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/@babel/runtime/helpers/toConsumableArray.js\n// module id = 1\n// module chunks = 0","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/@babel/runtime/helpers/classCallCheck.js\n// module id = 2\n// module chunks = 0","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/@babel/runtime/helpers/createClass.js\n// module id = 3\n// module chunks = 0","function n(n,t,r){return Math.max(t,Math.min(n,r))}function t(n,t,o,u){return void 0===u&&(u=!1),r(n,t,o,0,1,u)}function r(t,r,o,u,i,a){void 0===a&&(a=!1);var e=(t-r)*(i-u)/(o-r)+u;return a?n(e,u,i):e}function o(n,t,r){return n+r*(t-n)}function u(n,t,r){return void 0===r&&(r=Math.random),void 0!==t?o(n,t,r()):o(0,n,r())}function i(n,t,r){return void 0===r&&(r=Math.random),Math.floor(u(n,t,r))}function a(n){return 180*n/Math.PI}function e(n){return n*Math.PI/180}function f(n,t){return Math.ceil(n/t)*t}function c(n,t){return Math.floor(n/t)*t}function h(n,t){var r=n-Math.floor(n);return t?+r.toFixed(t):r}export{n as clamp,t as normalize,r as map,o as lerp,u as random,i as randomInt,a as degrees,e as radians,f as roundTo,c as floorTo,h as fract};\n//# sourceMappingURL=missing-math.m.js.map\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/missing-math/dist/missing-math.m.js\n// module id = 4\n// module chunks = 0","import hotkeys from 'hotkeys-js'\nimport raf from '@internet/raf'\nimport Scene from 'abstractions/Scene'\nimport points from './points.csv'\n\nwindow.addEventListener('click', () => {\n  document.getElementById('clickToStart').remove()\n\n  window.store = {\n    debug: false,\n\n    scene: {\n      color: '#333',\n      padding: 200 // px\n    },\n\n    phare: {\n      displayLights: true,\n\n      duration: {\n        awake: 3.5 * 1000 // ms\n      },\n\n      base: {\n        color: 'rgba(0, 0, 0, 0.2)',\n        radius: 800 / 2 // mm\n      },\n\n      led: {\n        length: 1700 // mm\n      },\n\n      arm: {\n        color: '#000',\n        length: 3000, // mm\n        offset: -500, // mm\n        thickness: 80 // mm\n      }\n    }\n  }\n\n  const canvas = document.querySelector('canvas')\n  window.scene = new Scene(canvas, points.filter(({x}) => !isNaN(x)).map(({x, y}) => ([x, -y])))\n\n  raf.add(dt => {\n    try {\n      window.scene.update(dt)\n    } catch (error) {\n      console.error(error)\n      raf.stop()\n    }\n  })\n\n  hotkeys('w', () => { window.store.debug = !window.store.debug })\n  hotkeys('l', () => { window.store.phare.displayLights = !window.store.phare.displayLights })\n  hotkeys('r', () => window.scene.clear())\n}, { once: true })\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","/*!\n * hotkeys-js v3.8.1\n * A simple micro-library for defining and dispatching keyboard shortcuts. It has no dependencies.\n * \n * Copyright (c) 2020 kenny wong <wowohoo@qq.com>\n * http://jaywcjlove.github.io/hotkeys\n * \n * Licensed under the MIT license.\n */\n\nvar isff = typeof navigator !== 'undefined' ? navigator.userAgent.toLowerCase().indexOf('firefox') > 0 : false; // 绑定事件\n\nfunction addEvent(object, event, method) {\n  if (object.addEventListener) {\n    object.addEventListener(event, method, false);\n  } else if (object.attachEvent) {\n    object.attachEvent(\"on\".concat(event), function () {\n      method(window.event);\n    });\n  }\n} // 修饰键转换成对应的键码\n\n\nfunction getMods(modifier, key) {\n  var mods = key.slice(0, key.length - 1);\n\n  for (var i = 0; i < mods.length; i++) {\n    mods[i] = modifier[mods[i].toLowerCase()];\n  }\n\n  return mods;\n} // 处理传的key字符串转换成数组\n\n\nfunction getKeys(key) {\n  if (typeof key !== 'string') key = '';\n  key = key.replace(/\\s/g, ''); // 匹配任何空白字符,包括空格、制表符、换页符等等\n\n  var keys = key.split(','); // 同时设置多个快捷键，以','分割\n\n  var index = keys.lastIndexOf(''); // 快捷键可能包含','，需特殊处理\n\n  for (; index >= 0;) {\n    keys[index - 1] += ',';\n    keys.splice(index, 1);\n    index = keys.lastIndexOf('');\n  }\n\n  return keys;\n} // 比较修饰键的数组\n\n\nfunction compareArray(a1, a2) {\n  var arr1 = a1.length >= a2.length ? a1 : a2;\n  var arr2 = a1.length >= a2.length ? a2 : a1;\n  var isIndex = true;\n\n  for (var i = 0; i < arr1.length; i++) {\n    if (arr2.indexOf(arr1[i]) === -1) isIndex = false;\n  }\n\n  return isIndex;\n}\n\nvar _keyMap = {\n  backspace: 8,\n  tab: 9,\n  clear: 12,\n  enter: 13,\n  return: 13,\n  esc: 27,\n  escape: 27,\n  space: 32,\n  left: 37,\n  up: 38,\n  right: 39,\n  down: 40,\n  del: 46,\n  delete: 46,\n  ins: 45,\n  insert: 45,\n  home: 36,\n  end: 35,\n  pageup: 33,\n  pagedown: 34,\n  capslock: 20,\n  '⇪': 20,\n  ',': 188,\n  '.': 190,\n  '/': 191,\n  '`': 192,\n  '-': isff ? 173 : 189,\n  '=': isff ? 61 : 187,\n  ';': isff ? 59 : 186,\n  '\\'': 222,\n  '[': 219,\n  ']': 221,\n  '\\\\': 220\n}; // Modifier Keys\n\nvar _modifier = {\n  // shiftKey\n  '⇧': 16,\n  shift: 16,\n  // altKey\n  '⌥': 18,\n  alt: 18,\n  option: 18,\n  // ctrlKey\n  '⌃': 17,\n  ctrl: 17,\n  control: 17,\n  // metaKey\n  '⌘': 91,\n  cmd: 91,\n  command: 91\n};\nvar modifierMap = {\n  16: 'shiftKey',\n  18: 'altKey',\n  17: 'ctrlKey',\n  91: 'metaKey',\n  shiftKey: 16,\n  ctrlKey: 17,\n  altKey: 18,\n  metaKey: 91\n};\nvar _mods = {\n  16: false,\n  18: false,\n  17: false,\n  91: false\n};\nvar _handlers = {}; // F1~F12 special key\n\nfor (var k = 1; k < 20; k++) {\n  _keyMap[\"f\".concat(k)] = 111 + k;\n}\n\nvar _downKeys = []; // 记录摁下的绑定键\n\nvar _scope = 'all'; // 默认热键范围\n\nvar elementHasBindEvent = []; // 已绑定事件的节点记录\n// 返回键码\n\nvar code = function code(x) {\n  return _keyMap[x.toLowerCase()] || _modifier[x.toLowerCase()] || x.toUpperCase().charCodeAt(0);\n}; // 设置获取当前范围（默认为'所有'）\n\n\nfunction setScope(scope) {\n  _scope = scope || 'all';\n} // 获取当前范围\n\n\nfunction getScope() {\n  return _scope || 'all';\n} // 获取摁下绑定键的键值\n\n\nfunction getPressedKeyCodes() {\n  return _downKeys.slice(0);\n} // 表单控件控件判断 返回 Boolean\n// hotkey is effective only when filter return true\n\n\nfunction filter(event) {\n  var target = event.target || event.srcElement;\n  var tagName = target.tagName;\n  var flag = true; // ignore: isContentEditable === 'true', <input> and <textarea> when readOnly state is false, <select>\n\n  if (target.isContentEditable || (tagName === 'INPUT' || tagName === 'TEXTAREA' || tagName === 'SELECT') && !target.readOnly) {\n    flag = false;\n  }\n\n  return flag;\n} // 判断摁下的键是否为某个键，返回true或者false\n\n\nfunction isPressed(keyCode) {\n  if (typeof keyCode === 'string') {\n    keyCode = code(keyCode); // 转换成键码\n  }\n\n  return _downKeys.indexOf(keyCode) !== -1;\n} // 循环删除handlers中的所有 scope(范围)\n\n\nfunction deleteScope(scope, newScope) {\n  var handlers;\n  var i; // 没有指定scope，获取scope\n\n  if (!scope) scope = getScope();\n\n  for (var key in _handlers) {\n    if (Object.prototype.hasOwnProperty.call(_handlers, key)) {\n      handlers = _handlers[key];\n\n      for (i = 0; i < handlers.length;) {\n        if (handlers[i].scope === scope) handlers.splice(i, 1);else i++;\n      }\n    }\n  } // 如果scope被删除，将scope重置为all\n\n\n  if (getScope() === scope) setScope(newScope || 'all');\n} // 清除修饰键\n\n\nfunction clearModifier(event) {\n  var key = event.keyCode || event.which || event.charCode;\n\n  var i = _downKeys.indexOf(key); // 从列表中清除按压过的键\n\n\n  if (i >= 0) {\n    _downKeys.splice(i, 1);\n  } // 特殊处理 cmmand 键，在 cmmand 组合快捷键 keyup 只执行一次的问题\n\n\n  if (event.key && event.key.toLowerCase() === 'meta') {\n    _downKeys.splice(0, _downKeys.length);\n  } // 修饰键 shiftKey altKey ctrlKey (command||metaKey) 清除\n\n\n  if (key === 93 || key === 224) key = 91;\n\n  if (key in _mods) {\n    _mods[key] = false; // 将修饰键重置为false\n\n    for (var k in _modifier) {\n      if (_modifier[k] === key) hotkeys[k] = false;\n    }\n  }\n}\n\nfunction unbind(keysInfo) {\n  // unbind(), unbind all keys\n  if (!keysInfo) {\n    Object.keys(_handlers).forEach(function (key) {\n      return delete _handlers[key];\n    });\n  } else if (Array.isArray(keysInfo)) {\n    // support like : unbind([{key: 'ctrl+a', scope: 's1'}, {key: 'ctrl-a', scope: 's2', splitKey: '-'}])\n    keysInfo.forEach(function (info) {\n      if (info.key) eachUnbind(info);\n    });\n  } else if (typeof keysInfo === 'object') {\n    // support like unbind({key: 'ctrl+a, ctrl+b', scope:'abc'})\n    if (keysInfo.key) eachUnbind(keysInfo);\n  } else if (typeof keysInfo === 'string') {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    // support old method\n    // eslint-disable-line\n    var scope = args[0],\n        method = args[1];\n\n    if (typeof scope === 'function') {\n      method = scope;\n      scope = '';\n    }\n\n    eachUnbind({\n      key: keysInfo,\n      scope: scope,\n      method: method,\n      splitKey: '+'\n    });\n  }\n} // 解除绑定某个范围的快捷键\n\n\nvar eachUnbind = function eachUnbind(_ref) {\n  var key = _ref.key,\n      scope = _ref.scope,\n      method = _ref.method,\n      _ref$splitKey = _ref.splitKey,\n      splitKey = _ref$splitKey === void 0 ? '+' : _ref$splitKey;\n  var multipleKeys = getKeys(key);\n  multipleKeys.forEach(function (originKey) {\n    var unbindKeys = originKey.split(splitKey);\n    var len = unbindKeys.length;\n    var lastKey = unbindKeys[len - 1];\n    var keyCode = lastKey === '*' ? '*' : code(lastKey);\n    if (!_handlers[keyCode]) return; // 判断是否传入范围，没有就获取范围\n\n    if (!scope) scope = getScope();\n    var mods = len > 1 ? getMods(_modifier, unbindKeys) : [];\n    _handlers[keyCode] = _handlers[keyCode].map(function (record) {\n      // 通过函数判断，是否解除绑定，函数相等直接返回\n      var isMatchingMethod = method ? record.method === method : true;\n\n      if (isMatchingMethod && record.scope === scope && compareArray(record.mods, mods)) {\n        return {};\n      }\n\n      return record;\n    });\n  });\n}; // 对监听对应快捷键的回调函数进行处理\n\n\nfunction eventHandler(event, handler, scope) {\n  var modifiersMatch; // 看它是否在当前范围\n\n  if (handler.scope === scope || handler.scope === 'all') {\n    // 检查是否匹配修饰符（如果有返回true）\n    modifiersMatch = handler.mods.length > 0;\n\n    for (var y in _mods) {\n      if (Object.prototype.hasOwnProperty.call(_mods, y)) {\n        if (!_mods[y] && handler.mods.indexOf(+y) > -1 || _mods[y] && handler.mods.indexOf(+y) === -1) {\n          modifiersMatch = false;\n        }\n      }\n    } // 调用处理程序，如果是修饰键不做处理\n\n\n    if (handler.mods.length === 0 && !_mods[16] && !_mods[18] && !_mods[17] && !_mods[91] || modifiersMatch || handler.shortcut === '*') {\n      if (handler.method(event, handler) === false) {\n        if (event.preventDefault) event.preventDefault();else event.returnValue = false;\n        if (event.stopPropagation) event.stopPropagation();\n        if (event.cancelBubble) event.cancelBubble = true;\n      }\n    }\n  }\n} // 处理keydown事件\n\n\nfunction dispatch(event) {\n  var asterisk = _handlers['*'];\n  var key = event.keyCode || event.which || event.charCode; // 表单控件过滤 默认表单控件不触发快捷键\n\n  if (!hotkeys.filter.call(this, event)) return; // Gecko(Firefox)的command键值224，在Webkit(Chrome)中保持一致\n  // Webkit左右 command 键值不一样\n\n  if (key === 93 || key === 224) key = 91;\n  /**\n   * Collect bound keys\n   * If an Input Method Editor is processing key input and the event is keydown, return 229.\n   * https://stackoverflow.com/questions/25043934/is-it-ok-to-ignore-keydown-events-with-keycode-229\n   * http://lists.w3.org/Archives/Public/www-dom/2010JulSep/att-0182/keyCode-spec.html\n   */\n\n  if (_downKeys.indexOf(key) === -1 && key !== 229) _downKeys.push(key);\n  /**\n   * Jest test cases are required.\n   * ===============================\n   */\n\n  ['ctrlKey', 'altKey', 'shiftKey', 'metaKey'].forEach(function (keyName) {\n    var keyNum = modifierMap[keyName];\n\n    if (event[keyName] && _downKeys.indexOf(keyNum) === -1) {\n      _downKeys.push(keyNum);\n    } else if (!event[keyName] && _downKeys.indexOf(keyNum) > -1) {\n      _downKeys.splice(_downKeys.indexOf(keyNum), 1);\n    } else if (keyName === 'metaKey' && event[keyName] && _downKeys.length === 3) {\n      /**\n       * Fix if Command is pressed:\n       * ===============================\n       */\n      if (!(event.ctrlKey || event.shiftKey || event.altKey)) {\n        _downKeys = _downKeys.slice(_downKeys.indexOf(keyNum));\n      }\n    }\n  });\n  /**\n   * -------------------------------\n   */\n\n  if (key in _mods) {\n    _mods[key] = true; // 将特殊字符的key注册到 hotkeys 上\n\n    for (var k in _modifier) {\n      if (_modifier[k] === key) hotkeys[k] = true;\n    }\n\n    if (!asterisk) return;\n  } // 将 modifierMap 里面的修饰键绑定到 event 中\n\n\n  for (var e in _mods) {\n    if (Object.prototype.hasOwnProperty.call(_mods, e)) {\n      _mods[e] = event[modifierMap[e]];\n    }\n  }\n  /**\n   * https://github.com/jaywcjlove/hotkeys/pull/129\n   * This solves the issue in Firefox on Windows where hotkeys corresponding to special characters would not trigger.\n   * An example of this is ctrl+alt+m on a Swedish keyboard which is used to type μ.\n   * Browser support: https://caniuse.com/#feat=keyboardevent-getmodifierstate\n   */\n\n\n  if (event.getModifierState && !(event.altKey && !event.ctrlKey) && event.getModifierState('AltGraph')) {\n    if (_downKeys.indexOf(17) === -1) {\n      _downKeys.push(17);\n    }\n\n    if (_downKeys.indexOf(18) === -1) {\n      _downKeys.push(18);\n    }\n\n    _mods[17] = true;\n    _mods[18] = true;\n  } // 获取范围 默认为 `all`\n\n\n  var scope = getScope(); // 对任何快捷键都需要做的处理\n\n  if (asterisk) {\n    for (var i = 0; i < asterisk.length; i++) {\n      if (asterisk[i].scope === scope && (event.type === 'keydown' && asterisk[i].keydown || event.type === 'keyup' && asterisk[i].keyup)) {\n        eventHandler(event, asterisk[i], scope);\n      }\n    }\n  } // key 不在 _handlers 中返回\n\n\n  if (!(key in _handlers)) return;\n\n  for (var _i = 0; _i < _handlers[key].length; _i++) {\n    if (event.type === 'keydown' && _handlers[key][_i].keydown || event.type === 'keyup' && _handlers[key][_i].keyup) {\n      if (_handlers[key][_i].key) {\n        var record = _handlers[key][_i];\n        var splitKey = record.splitKey;\n        var keyShortcut = record.key.split(splitKey);\n        var _downKeysCurrent = []; // 记录当前按键键值\n\n        for (var a = 0; a < keyShortcut.length; a++) {\n          _downKeysCurrent.push(code(keyShortcut[a]));\n        }\n\n        if (_downKeysCurrent.sort().join('') === _downKeys.sort().join('')) {\n          // 找到处理内容\n          eventHandler(event, record, scope);\n        }\n      }\n    }\n  }\n} // 判断 element 是否已经绑定事件\n\n\nfunction isElementBind(element) {\n  return elementHasBindEvent.indexOf(element) > -1;\n}\n\nfunction hotkeys(key, option, method) {\n  _downKeys = [];\n  var keys = getKeys(key); // 需要处理的快捷键列表\n\n  var mods = [];\n  var scope = 'all'; // scope默认为all，所有范围都有效\n\n  var element = document; // 快捷键事件绑定节点\n\n  var i = 0;\n  var keyup = false;\n  var keydown = true;\n  var splitKey = '+'; // 对为设定范围的判断\n\n  if (method === undefined && typeof option === 'function') {\n    method = option;\n  }\n\n  if (Object.prototype.toString.call(option) === '[object Object]') {\n    if (option.scope) scope = option.scope; // eslint-disable-line\n\n    if (option.element) element = option.element; // eslint-disable-line\n\n    if (option.keyup) keyup = option.keyup; // eslint-disable-line\n\n    if (option.keydown !== undefined) keydown = option.keydown; // eslint-disable-line\n\n    if (typeof option.splitKey === 'string') splitKey = option.splitKey; // eslint-disable-line\n  }\n\n  if (typeof option === 'string') scope = option; // 对于每个快捷键进行处理\n\n  for (; i < keys.length; i++) {\n    key = keys[i].split(splitKey); // 按键列表\n\n    mods = []; // 如果是组合快捷键取得组合快捷键\n\n    if (key.length > 1) mods = getMods(_modifier, key); // 将非修饰键转化为键码\n\n    key = key[key.length - 1];\n    key = key === '*' ? '*' : code(key); // *表示匹配所有快捷键\n    // 判断key是否在_handlers中，不在就赋一个空数组\n\n    if (!(key in _handlers)) _handlers[key] = [];\n\n    _handlers[key].push({\n      keyup: keyup,\n      keydown: keydown,\n      scope: scope,\n      mods: mods,\n      shortcut: keys[i],\n      method: method,\n      key: keys[i],\n      splitKey: splitKey\n    });\n  } // 在全局document上设置快捷键\n\n\n  if (typeof element !== 'undefined' && !isElementBind(element) && window) {\n    elementHasBindEvent.push(element);\n    addEvent(element, 'keydown', function (e) {\n      dispatch(e);\n    });\n    addEvent(window, 'focus', function () {\n      _downKeys = [];\n    });\n    addEvent(element, 'keyup', function (e) {\n      dispatch(e);\n      clearModifier(e);\n    });\n  }\n}\n\nvar _api = {\n  setScope: setScope,\n  getScope: getScope,\n  deleteScope: deleteScope,\n  getPressedKeyCodes: getPressedKeyCodes,\n  isPressed: isPressed,\n  filter: filter,\n  unbind: unbind\n};\n\nfor (var a in _api) {\n  if (Object.prototype.hasOwnProperty.call(_api, a)) {\n    hotkeys[a] = _api[a];\n  }\n}\n\nif (typeof window !== 'undefined') {\n  var _hotkeys = window.hotkeys;\n\n  hotkeys.noConflict = function (deep) {\n    if (deep && window.hotkeys === hotkeys) {\n      window.hotkeys = _hotkeys;\n    }\n\n    return hotkeys;\n  };\n\n  window.hotkeys = hotkeys;\n}\n\nexport default hotkeys;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/hotkeys-js/dist/hotkeys.esm.js\n// module id = 7\n// module chunks = 0","import RafTimer from './RafTimer.js'\nimport fpsLimiter from './fpsLimiter.js'\nimport raf from './raf.js'\n\nexport { RafTimer, fpsLimiter, raf }\nexport default raf\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/@internet/raf/lib/index.js\n// module id = 8\n// module chunks = 0","'use strict'\n\n/**\n * Create a new RafTimer instance.\n * @class RafTimer\n * @param {number} delay Number of milliseconds before executing the callback.\n * @param {Function} cb Callback function executed when the timer hit 0. For convenience, a restart method will be passed as 1st arg of the cb function.\n * @param {boolean} [autostart=true] Optional (default true). Auto-start the timer (Don't need to call start() method).\n * @constructor\n * @example\n * import { raf, RafTimer } from '@internet/raf'\n *\n * const timer = new RafTimer(2000, restart => {\n *   console.log('Will be logged after 2000ms')\n *   restart() // Restart the timer. onDone will be called after another 2000ms.\n * })\n *\n * raf.add(dt => timer.update(dt))\n */\n\nfunction RafTimer (delay, cb, autostart) {\n  if (autostart === void 0) autostart = true\n\n  this._stopped = !autostart\n  this._remainder = 0\n  this._delay = delay | 0\n  this._remainingTime = delay\n  this._callback = cb === undefined ? function () {} : cb\n\n  // fast binding\n  var restart = this.restart\n  var self = this\n  this.restart = function (n, u) { restart.call(self, n, u) }\n\n  if (this._delay === 0) this._stopped = true\n}\n\n/**\n * Set a new callback function.\n * @method\n * @param {function} newCallback New callback function. For convenience, a restart method will be passed as 1st arg of the cb function.\n * @param {number} [newDelay] Optional. Set a new delay (in ms). If set, the timer will be restarted\n */\nRafTimer.prototype.setCallback = function setCallback (newCallback, newDelay) {\n  this._callback = newCallback === undefined ? function () {} : newCallback\n  if (newDelay) this.restart(newDelay)\n}\n\n/**\n * Stop the timer. update() calls will do nothing.\n * @method\n */\nRafTimer.prototype.stop = function stop () {\n  this._stopped = true\n}\n\n/**\n * Start the timer if stopped.\n * @method\n */\nRafTimer.prototype.start = function start () {\n  if (!this._stopped) return\n  this.restart()\n}\n\n/**\n * Restart the timer\n * @method\n * @param {number} newDelay\n * @param {boolean} [useRemainder=true] Optional (default true). Use deltatime's remainder from the last time the timer hits 0.\n */\nRafTimer.prototype.restart = function restart (newDelay, useRemainder) {\n  if (useRemainder === void 0) useRemainder = true\n\n  if (newDelay !== undefined) this._delay = newDelay\n  this._stopped = false\n  this._remainingTime = this._delay - (this._remainder * (+useRemainder))\n}\n\n/**\n * Update remaining time. Usually executed inside a requestAnimationFrame call.\n * @method\n * @param {number} dt Time elapsed since the last call (in ms).\n */\nRafTimer.prototype.update = function update (dt) {\n  if (this._stopped) return\n  this._remainingTime -= dt\n  if (this._remainingTime <= 0) {\n    this._stopped = true\n    this._remainder = (-this._remainingTime) % this._delay\n    this._callback(this.restart)\n  } else {\n    this._remainder = 0\n  }\n}\n\n/**\n * Stop the timer and remove callback reference\n * @method\n */\nRafTimer.prototype.dispose = function dispose () {\n  this._callback = this.restart = function () {}\n  this._stopped = true\n  this._remainder = 0\n  this._remainingTime = this._delay\n}\n\nexport default RafTimer\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/@internet/raf/lib/RafTimer.js\n// module id = 9\n// module chunks = 0","'use strict'\n\n/**\n * Limit function calls to a specific framerate\n * @param {number} [framerate=30] Framerate\n * @param {function} callback Function to be called at the specified frame interval\n * @return {function} Framerate-limited function to add to your raf\n * @example\n * import { raf, fpsLimiter } from '@internet/raf'\n *\n * function tick () {\n *   console.log('called each 10 fps')\n * }\n *\n * const limited = fpsLimiter(10, tick)\n * raf.add(limited)\n */\nfunction fpsLimiter (framerate, callback) {\n  if (callback === void 0) throw new Error('You must specify a callback')\n  if (framerate === void 0) framerate = 30\n  var _interval = 1000 / framerate\n  var _remainingTime = 0\n  var _elapsedTime = 0\n  return function (dt) {\n    _remainingTime -= dt\n    _elapsedTime += dt\n    if (_remainingTime <= 0) {\n      callback(_elapsedTime)\n      _elapsedTime = 0\n      _remainingTime = _interval + (_remainingTime % _interval)\n    }\n  }\n}\n\nexport default fpsLimiter\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/@internet/raf/lib/fpsLimiter.js\n// module id = 10\n// module chunks = 0","'use strict'\n\n/**\n * Core of the raf package\n * @module raf\n * @type {Object}\n * @example\n * import { raf } from '@internet/raf'\n *\n * function tick (dt) {\n *  console.log('called on new frame')\n * }\n *\n * raf.add(tick)\n */\n\nvar root = typeof window === 'undefined' ? global : window\nvar _observers = []\nvar _afterObservers = []\nvar _beforeObservers = []\nvar _rafHandler = null\nvar _lastDate = null\nvar _once = false\nvar _complex = false\n\n/**\n * Time elapsed between the previous and the current frame\n * @type {number}\n * @static\n * @category properties\n */\nvar time\n\n/**\n * Current delta time\n * @type {number}\n * @static\n * @category properties\n */\nvar dt\n\nfunction _frame (timestamp) {\n  // compute deltatime and time\n  if (timestamp === void 0) timestamp = 0\n  if (_lastDate === null) _lastDate = timestamp\n  dt = timestamp - _lastDate\n  time += dt\n  _lastDate = timestamp\n  // we request the frame now, allowing to cancel it from observers\n  _rafHandler = _once ? null : root.requestAnimationFrame(_frame)\n  if (_once) _once = false\n  // call all observers\n  var i\n  if (_complex) {\n    for (i = 0; i < _beforeObservers.length; i++) _beforeObservers[i](dt)\n    for (i = 0; i < _observers.length; i++) _observers[i](dt)\n    for (i = 0; i < _afterObservers.length; i++) _afterObservers[i](dt)\n  } else {\n    for (i = 0; i < _observers.length; i++) _observers[i](dt)\n  }\n}\n\nfunction _swapRunner () {\n  _complex = !!(_afterObservers.length > 0 || _beforeObservers.length > 0)\n}\n\nfunction _addObserver (arr, fn, prepend) {\n  if (!fn || !arr) return false\n  if (~arr.indexOf(fn)) return false\n  prepend = !!prepend\n  prepend ? arr.unshift(fn) : arr.push(fn)\n  return true\n}\n\nfunction _removeObserver (arr, fn) {\n  if (!fn) return false\n  var index = arr.indexOf(fn)\n  if (!~index) return false\n  arr.splice(index, 1)\n  return !!(arr.length === 0)\n}\n\n/**\n * Add a function for execution at the beginning of the raf call\n * Calling addBefore will not start the raf.\n * @param {function} fn Function to be called at the start of the raf\n * @param {function} [prepend=false] Prepend the function to the beginning of the functions list\n * @static\n * @category methods\n */\nfunction addBefore (fn, prepend) {\n  _addObserver(_beforeObservers, fn, prepend) && _swapRunner()\n}\n\n/**\n * Add a function for execution at the end of the raf call\n * Calling addAfter will not start the raf.\n * @param {function} fn Function to be called at the end of the raf\n * @param {function} [prepend=false] Prepend the function to the beginning of the functions list\n * @static\n * @category methods\n */\nfunction addAfter (fn, prepend) {\n  _addObserver(_afterObservers, fn, prepend) && _swapRunner()\n}\n\n/**\n * Add a function for execution on each frame\n * @param {function} fn Function to be called\n * @param {function} [prepend=false] Prepend the function to the beginning of the functions list\n * @static\n * @category methods\n */\nfunction add (fn, prepend) {\n  _addObserver(_observers, fn, prepend) && start()\n}\n\n/**\n * Remove a function for execution at the beginning of the raf call\n * Calling removeBefore will not stop the raf.\n * @param {function} fn Function to remove from the raf\n * @static\n * @category methods\n */\nfunction removeBefore (fn) {\n  _removeObserver(_beforeObservers, fn) && _swapRunner()\n}\n\n/**\n * Remove a function for execution at the end of the raf call\n * Calling removeAfter will not stop the raf.\n * @param {function} fn Function to remove from the raf\n * @param {function} [prepend=false] Prepend the function to the beginning of the functions list\n * @static\n * @category methods\n */\nfunction removeAfter (fn, prepend) {\n  _removeObserver(_afterObservers, fn) && _swapRunner()\n}\n\n/**\n * Remove a function for execution on each frame\n * @param {function} fn Function to remove from the raf\n * @static\n * @category methods\n */\nfunction remove (fn) {\n  _removeObserver(_observers, fn) && stop()\n}\n\n/**\n * Force start the raf. You usually don't need to use it.\n * @param {boolean} [instant=false] Directly make a raf call without waiting for the next frame (default false)\n * @static\n * @category methods\n */\nfunction start (instant) {\n  _once = false\n  if (_rafHandler) return\n  instant = !!instant\n  _lastDate = null\n  if (instant) _frame()\n  else _rafHandler = root.requestAnimationFrame(_frame)\n}\n\n/**\n * Request once the raf. Will not be executed if the raf is already running.\n * @static\n * @category methods\n */\nfunction requestOnce () {\n  if (_rafHandler) return\n  _once = true\n  _lastDate = null\n  _rafHandler = root.requestAnimationFrame(_frame)\n}\n\n/**\n * Force stop the raf. You usually don't need to use it.\n * @static\n * @category methods\n */\nfunction stop () {\n  if (!_rafHandler) return\n  root.cancelAnimationFrame(_rafHandler)\n  _rafHandler = null\n}\n\n/**\n * Remove all observers from the raf singleton and stop the raf if it's running. Reset time.\n * @static\n * @category methods\n */\nfunction dispose () {\n  stop()\n  _observers.length = 0\n  _afterObservers.length = 0\n  _beforeObservers.length = 0\n  _complex = false\n  _lastDate = null\n  time = 0\n  dt = 0\n}\n\nexport default {\n  add: add,\n  addAfter: addAfter,\n  addBefore: addBefore,\n  remove: remove,\n  removeAfter: removeAfter,\n  removeBefore: removeBefore,\n  start: start,\n  stop: stop,\n  time: time,\n  dt: dt,\n  requestOnce: requestOnce,\n  dispose: dispose\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/@internet/raf/lib/raf.js\n// module id = 11\n// module chunks = 0","var g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === \"object\")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// (webpack)/buildin/global.js\n// module id = 12\n// module chunks = 0","import Phare from 'abstractions/Phare'\nimport BoundingBox from 'abstractions/BoundingBox'\n\nexport default class Scene {\n  constructor (canvas, points) {\n    this.handleResize = this.handleResize.bind(this)\n    this.handleClick = this.handleClick.bind(this)\n    this.update = this.update.bind(this)\n\n    this.props = { canvas, points }\n\n    this.ctx = canvas.getContext('2d')\n    this.bbox = new BoundingBox(points)\n    this.phares = points.map(([x, y]) => new Phare(x, y))\n\n    this.handleResize()\n\n    window.addEventListener('resize', this.handleResize)\n    this.props.canvas.addEventListener('click', this.handleClick)\n  }\n\n  get width () { return this.props.canvas.width }\n  get height () { return this.props.canvas.height }\n\n  clear () {\n    this.phares.length = 0\n  }\n\n  add (x, y) {\n    this.phares.push(new Phare(...this.screenToWorld(x, y)))\n  }\n\n  handleResize () {\n    this.dpi = 1\n\n    this.props.canvas.width = window.innerWidth * this.dpi\n    this.props.canvas.height = window.innerHeight * this.dpi\n    this.props.canvas.style.width = window.innerWidth + 'px'\n    this.props.canvas.style.height = window.innerHeight + 'px'\n\n    this.scale = Math.min(\n      (this.width - window.store.scene.padding * 2) / this.bbox.width,\n      (this.height - window.store.scene.padding * 2) / this.bbox.height\n    )\n\n    this.offset = [\n      (((this.width / this.scale) - this.bbox.width) / 2) - this.bbox.xmin,\n      (((this.height / this.scale) - this.bbox.height) / 2) - this.bbox.ymin\n    ]\n  }\n\n  // click on a Phare to trigger\n  // click on the Scene to add a Phare\n  // shift + click on a Phare to delete\n  handleClick (e) {\n    const position = this.screenToWorld(e.offsetX, e.offsetY)\n    const activeIndex = this.phares.findIndex(phare => phare.isUnder(position))\n    if (activeIndex > -1) {\n      if (e.shiftKey) this.phares.splice(activeIndex, 1)\n      else this.phares[activeIndex].trigger(true)\n    } else {\n      this.phares.push(new Phare(...this.screenToWorld(e.offsetX, e.offsetY)))\n    }\n  }\n\n  screenToWorld (x, y) {\n    return [\n      x / (this.scale / this.dpi) - this.offset[0],\n      y / (this.scale / this.dpi) - this.offset[1]\n    ]\n  }\n\n  update (dt) {\n    this.props.canvas.style['background'] = window.store.scene.color\n    this.ctx.clearRect(0, 0, this.width, this.height)\n\n    this.ctx.save()\n    this.ctx.scale(this.scale, this.scale)\n    this.ctx.translate(this.offset[0], this.offset[1])\n\n    this.phares.forEach(phare => phare.update(dt))\n    this.phares.forEach(phare => {\n      this.phares.forEach(candidate => {\n        phare.hit(candidate) && candidate.trigger()\n      })\n\n      phare.render(this.ctx, this.scale * this.dpi)\n      if (window.store.debug) phare.debugGeometry(this.ctx, this.scale * this.dpi)\n    })\n\n    this.ctx.restore()\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/abstractions/Scene.js","var setPrototypeOf = require(\"./setPrototypeOf\");\n\nfunction isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _construct(Parent, args, Class) {\n  if (isNativeReflectConstruct()) {\n    module.exports = _construct = Reflect.construct;\n  } else {\n    module.exports = _construct = function _construct(Parent, args, Class) {\n      var a = [null];\n      a.push.apply(a, args);\n      var Constructor = Function.bind.apply(Parent, a);\n      var instance = new Constructor();\n      if (Class) setPrototypeOf(instance, Class.prototype);\n      return instance;\n    };\n  }\n\n  return _construct.apply(null, arguments);\n}\n\nmodule.exports = _construct;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/@babel/runtime/helpers/construct.js\n// module id = 14\n// module chunks = 0","function _setPrototypeOf(o, p) {\n  module.exports = _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nmodule.exports = _setPrototypeOf;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/@babel/runtime/helpers/setPrototypeOf.js\n// module id = 15\n// module chunks = 0","function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  }\n}\n\nmodule.exports = _arrayWithoutHoles;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/@babel/runtime/helpers/arrayWithoutHoles.js\n// module id = 16\n// module chunks = 0","function _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}\n\nmodule.exports = _iterableToArray;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/@babel/runtime/helpers/iterableToArray.js\n// module id = 17\n// module chunks = 0","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}\n\nmodule.exports = _nonIterableSpread;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/@babel/runtime/helpers/nonIterableSpread.js\n// module id = 18\n// module chunks = 0","function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nmodule.exports = _arrayWithHoles;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/@babel/runtime/helpers/arrayWithHoles.js\n// module id = 19\n// module chunks = 0","function _iterableToArrayLimit(arr, i) {\n  if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === \"[object Arguments]\")) {\n    return;\n  }\n\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nmodule.exports = _iterableToArrayLimit;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/@babel/runtime/helpers/iterableToArrayLimit.js\n// module id = 20\n// module chunks = 0","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n}\n\nmodule.exports = _nonIterableRest;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/@babel/runtime/helpers/nonIterableRest.js\n// module id = 21\n// module chunks = 0","/* global Audio */\nimport intersect from 'segseg'\nimport { degrees, radians, random, randomInt, lerp, clamp } from 'missing-math'\nimport dist from 'utils/distance'\nimport fallOff from 'utils/simulate-falloff'\n\nexport default class Phare {\n  constructor (x, y) {\n    this.position = [x, y]\n    this.radius = window.store.phare.arm.length + window.store.phare.arm.offset\n\n    this.alpha = random(0, 360)\n    this.state = 'iddle'\n    this.direction = Math.sign(random(-1, 1))\n\n    const i = randomInt(4, 7)\n    this.sound = new Audio(`FA-S${i}-20210525v2.wav`)\n\n    this.seed = Math.random() * 9999\n  }\n\n  get state () { return this._state }\n  set state (s) {\n    this.stateTime = 0\n    this._state = s\n  }\n\n  get body () {\n    return [\n      this.position,\n      [\n        this.position[0] + Math.cos(radians(this.alpha)) * this.radius,\n        this.position[1] + Math.sin(radians(this.alpha)) * this.radius\n      ]\n    ]\n  }\n\n  get sensor () {\n    return [\n      [\n        this.position[0] + Math.cos(radians(this.alpha)) * this.radius * 0.9,\n        this.position[1] + Math.sin(radians(this.alpha)) * this.radius * 0.9\n      ],\n      [\n        this.position[0] + Math.cos(radians(this.alpha)) * this.radius,\n        this.position[1] + Math.sin(radians(this.alpha)) * this.radius\n      ]\n    ]\n  }\n\n  isUnder (realWorldTarget) {\n    return dist(this.position, realWorldTarget) < this.radius\n  }\n\n  update (dt) {\n    this.stateTime += dt\n\n    switch (this.state) {\n      case 'iddle': {\n        this.alpha += this.direction * 0.1\n        break\n      }\n\n      case 'awake': {\n        if (this.stateTime > window.store.phare.duration.awake) {\n          this.state = 'iddle'\n          this.direction = -this.direction\n          break\n        }\n\n        const brake = 1 - (this.stateTime / window.store.phare.duration.awake) ** 2\n\n        // SEE https://github.com/Hemisphere-Project/FarAway/blob/master/Simulation/Acceleration_theorique_FarAway/Acceleration_theorique_FarAway.pde\n        const J = 2.73\n        const K1 = 4.5 / (J * 2)\n        const pt = this.stateTime - dt\n        const t = this.stateTime\n\n        const step = degrees(K1 * pt * pt / 1000000) - degrees(K1 * t * t / 1000000)\n        this.alpha += step * brake * -this.direction\n        break\n      }\n    }\n  }\n\n  trigger (force = false) {\n    this.sound.play()\n\n    // XXX: Toggle multiple trigger in one awake session\n    if (!force && this.state === 'awake') return\n    // if (!force && this.state === 'awake' && this.stateTime < 500) return\n\n    this.sound.currentTime = 0\n    this.state = 'awake'\n  }\n\n  hit (phare) {\n    if (phare === this) return\n    return intersect([], ...this.body, ...phare.sensor)\n  }\n\n  render (ctx, scale) {\n    ctx.lineCap = 'round'\n    const { base, arm, led, displayLights } = window.store.phare\n\n    ctx.save()\n    ctx.translate(this.position[0], this.position[1])\n    ctx.rotate(radians(this.alpha))\n\n    // Render base\n    ctx.fillStyle = base.color\n    ctx.beginPath()\n    ctx.arc(0, 0, base.radius, 0, Math.PI * 2)\n    ctx.fill()\n\n    if (displayLights) { // Render light\n      const light = this.computeLight()\n      const a = (arm.length + arm.offset) - led.length\n      const b = (arm.length + arm.offset)\n      fallOff(({ intensity, density }) => {\n        const [R, G, B] = light.rgba\n        ctx.beginPath()\n        ctx.strokeStyle = `rgba(${R}, ${G}, ${B}, ${intensity})`\n        ctx.lineWidth = density\n        ctx.moveTo(lerp(a, b, light.bounds[0]), 0)\n        ctx.lineTo(lerp(a, b, light.bounds[1]), 0)\n        ctx.stroke()\n\n        // HACK: Blink a white LED when iddle\n        if (this.state === 'iddle') {\n          const t = (Math.sin(this.seed + this.stateTime / 500) + 1) / 2\n          ctx.beginPath()\n          ctx.strokeStyle = `rgba(255, 255, 255, ${intensity * 2 * t})`\n          ctx.moveTo(b, 0)\n          ctx.lineTo(b, 0)\n          ctx.stroke()\n        }\n      }, {\n        initialIntensity: light.rgba[3],\n        initialDensity: Math.max(1 / scale, arm.thickness),\n        passes: 8\n      })\n    }\n\n    // Render arm\n    ctx.beginPath()\n    ctx.strokeStyle = arm.color\n    ctx.lineWidth = Math.max(1 / scale, arm.thickness)\n    ctx.moveTo(arm.offset, 0)\n    ctx.lineTo(arm.length + arm.offset, 0)\n    ctx.stroke()\n\n    // Render back light\n    displayLights && fallOff(({ intensity, density }) => {\n      ctx.fillStyle = `rgba(255, 0, 0, ${intensity})`\n      ctx.beginPath()\n      ctx.arc(arm.offset, 0, density, 0, Math.PI * 2)\n      ctx.fill()\n    }, {\n      passes: 3,\n      initialIntensity: 0.2,\n      initialDensity: arm.thickness / 2\n    })\n\n    ctx.restore()\n  }\n\n  computeLight () {\n    switch (this.state) {\n      case 'iddle': {\n        const t = clamp((this.stateTime / 1000) * 2, 0, 1)\n        return {\n          rgba: [255, 0, 0, t * 0.3],\n          bounds: [0, 1]\n        }\n      }\n\n      case 'awake': {\n        const t1 = clamp(this.stateTime / 50, 0, 1)\n        const t2 = (1 - (this.stateTime / window.store.phare.duration.awake) ** 3)\n        return {\n          rgba: [255, 255, 255, t2],\n          bounds: [1 - t1, 1]\n        }\n      }\n    }\n  }\n\n  debugGeometry (ctx, scale) {\n    switch (this.state) {\n      default:\n      case 'iddle': ctx.strokeStyle = 'rgba(255, 255, 255, 0.2)'; break\n      case 'awake': ctx.strokeStyle = 'rgba(255, 255, 255, 1)'; break\n    }\n\n    ctx.fillStyle = 'rgba(255, 255, 255, 0.05)'\n    ctx.lineWidth = 1 / scale\n\n    // Radius\n    ctx.beginPath()\n    ctx.arc(this.position[0], this.position[1], this.radius, 0, Math.PI * 2)\n    ctx.fill()\n    ctx.stroke()\n\n    // Ray\n    ctx.beginPath()\n    ctx.strokeStyle = 'cyan'\n    ctx.moveTo(this.sensor[0][0], this.sensor[0][1])\n    ctx.lineTo(this.sensor[1][0], this.sensor[1][1])\n    ctx.stroke()\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/abstractions/Phare.js","import segpoint from './segpoint.js'\n\n\nconst DONT_INTERSECT = 0\nconst DO_INTERSECT = 1\nconst COLINEAR = 2\n\n\n/*  Ported from Mukesh Prasad's public domain code:\n *    http://www.realtimerendering.com/resources/GraphicsGems/gemsii/xlines.c\n *\n *   This function computes whether two line segments,\n *   respectively joining the input points (x1,y1) -- (x2,y2)\n *   and the input points (x3,y3) -- (x4,y4) intersect.\n *   If the lines intersect, the return value is an array\n *   containing coordinates of the point of intersection.\n *\n *   Params\n *        p1, p2   Coordinates of endpoints of one segment.\n *        p3, p4   Coordinates of endpoints of other segment.\n *\n *   The value returned by the function is an enumeration of DONT_INTERSECT | DO_INTERSECT | COLINEAR\n */\n\nfunction _segseg (out, p1, p2, p3, p4) {\n  let x1 = p1[0]\n  let y1 = p1[1]\n  let x2 = p2[0]\n  let y2 = p2[1]\n  let x3 = p3[0]\n  let y3 = p3[1]\n  let x4 = p4[0]\n  let y4 = p4[1]\n\n  let a1, a2, b1, b2, c1, c2 // Coefficients of line eqns.\n  let r1, r2, r3, r4         // 'Sign' values\n  let denom, offset          // Intermediate values\n  let x, y                   // Intermediate return values\n\n  // Compute a1, b1, c1, where line joining points 1 and 2\n  // is \"a1 x  +  b1 y  +  c1  =  0\".\n  a1 = y2 - y1\n  b1 = x1 - x2\n  c1 = x2 * y1 - x1 * y2\n\n  // Compute r3 and r4.\n  r3 = a1 * x3 + b1 * y3 + c1\n  r4 = a1 * x4 + b1 * y4 + c1\n\n  // Check signs of r3 and r4.  If both point 3 and point 4 lie on\n  // same side of line 1, the line segments do not intersect.\n  if ( r3 !== 0 && r4 !== 0 && ((r3 >= 0 && r4 >= 0) || (r3 < 0 && r4 < 0)))\n    return DONT_INTERSECT\n\n  // Compute a2, b2, c2\n  a2 = y4 - y3\n  b2 = x3 - x4\n  c2 = x4 * y3 - x3 * y4\n\n  // Compute r1 and r2\n  r1 = a2 * x1 + b2 * y1 + c2\n  r2 = a2 * x2 + b2 * y2 + c2\n\n  // Check signs of r1 and r2.  If both point 1 and point 2 lie\n  // on same side of second line segment, the line segments do\n  // not intersect.\n  if (r1 !== 0 && r2 !== 0 && ((r1 >= 0 && r2 >= 0) || (r1 < 0 && r2 < 0)))\n    return DONT_INTERSECT\n\n  // Line segments intersect: compute intersection point.\n  denom = a1 * b2 - a2 * b1\n\n  if (denom === 0)\n    return COLINEAR\n\n  offset = denom < 0 ? - denom / 2 : denom / 2\n\n  x = b1 * c2 - b2 * c1\n  y = a2 * c1 - a1 * c2\n\n  out[0] = ( x < 0 ? x : x ) / denom\n  out[1] = ( y < 0 ? y : y ) / denom\n  \n  return DO_INTERSECT\n}\n\n\nexport default function segseg (out, p1, p2, p3, p4) {\n  const result = _segseg(out, p1, p2, p3, p4)\n\n  if (result === DO_INTERSECT)\n    return result\n\n  // handle colinear cases and when a line segment endpoint lies on the other segment\n  if (segpoint(p1, p3, p4)) {\n    out[0] = p1[0]\n    out[1] = p1[1]\n    return true\n  }\n\n  if (segpoint(p2, p3, p4)) {\n    out[0] = p2[0]\n    out[1] = p2[1]\n    return true\n  }\n\n  if (segpoint(p3, p1, p2)) {\n    out[0] = p3[0]\n    out[1] = p3[1]\n    return true\n  }\n\n  if (segpoint(p4, p1, p2)) {\n    out[0] = p4[0]\n    out[1] = p4[1]\n    return true\n  }\n\n  return false\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/segseg/index.js\n// module id = 23\n// module chunks = 0","// from https://gist.github.com/mattdesl/47412d930dcd8cd765c871a65532ffac\n\nfunction sqr (x) {\n  return x * x\n}\n\n\nfunction dist2 (v, w) {\n  return sqr(v[0] - w[0]) + sqr(v[1] - w[1])\n}\n\n\n// p - point\n// v - start point of segment\n// w - end point of segment\nfunction distToSegmentSquared (p, v, w) {\n  const l2 = dist2(v, w)\n  if (l2 === 0)\n      return dist2(p, v)\n\n  let t = ((p[0] - v[0]) * (w[0] - v[0]) + (p[1] - v[1]) * (w[1] - v[1])) / l2\n  t = Math.max(0, Math.min(1, t))\n  return dist2(p, [ v[0] + t * (w[0] - v[0]), v[1] + t * (w[1] - v[1]) ])\n}\n\n\n// p - point\n// t0 - start point of segment\n// t1 - end point of segment\n// return boolean indicating if p is on the segment\nexport default function distToSegment (p, t0, t1) {\n  return Math.sqrt(distToSegmentSquared(p, t0, t1)) < 1\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/segseg/segpoint.js\n// module id = 24\n// module chunks = 0","export default function ([x1, y1], [x2, y2]) {\n  const dx = x2 - x1\n  const dy = y2 - y1\n  return Math.sqrt(dx * dx + dy * dy)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/distance.js","import { lerp } from 'missing-math'\n\nexport default function (render, { passes = 5, initialIntensity = 1, initialDensity = 1 } = {}) {\n  for (let i = 0; i < passes; i++) {\n    const n = i / passes\n    const intensity = i ? lerp(initialIntensity * 0.1, 0, 1 - n ** 2) : initialIntensity\n    const density = initialDensity * (i ? (100 - (n ** 1.3) * 100) : 3)\n    if (intensity < 0.0001) break\n\n    render({ intensity, density })\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/simulate-falloff.js","export default function (points) {\n  const bbox = {\n    xmin: Number.POSITIVE_INFINITY,\n    xmax: Number.NEGATIVE_INFINITY,\n    ymin: Number.POSITIVE_INFINITY,\n    ymax: Number.NEGATIVE_INFINITY,\n    get width () { return Math.abs(this.xmax - this.xmin) },\n    get height () { return Math.abs(this.ymax - this.ymin) }\n  }\n\n  for (const [x, y] of points) {\n    if (x < bbox.xmin) bbox.xmin = x\n    if (x > bbox.xmax) bbox.xmax = x\n    if (y < bbox.ymin) bbox.ymin = y\n    if (y > bbox.ymax) bbox.ymax = y\n  }\n\n  return bbox\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/abstractions/BoundingBox.js","module.exports = [{\"x\":-33604.9109,\"y\":170070.6215,\"z\":3.038},{\"x\":-37104.9109,\"y\":170070.6215,\"z\":3.038},{\"x\":-40604.9109,\"y\":170070.6215,\"z\":3.038},{\"x\":-44104.9109,\"y\":170070.6215,\"z\":3.038},{\"x\":-47604.9109,\"y\":170070.6215,\"z\":3.038},{\"x\":-51104.9109,\"y\":170070.6215,\"z\":3.038},{\"x\":-54604.9109,\"y\":170070.6215,\"z\":3.038},{\"x\":-58104.9109,\"y\":170070.6215,\"z\":3.038},{\"x\":-61604.9109,\"y\":170070.6215,\"z\":3.038},{\"x\":-65104.9109,\"y\":170070.6215,\"z\":3.038},{\"x\":-68604.9109,\"y\":170070.6215,\"z\":3.038},{\"x\":-72104.9109,\"y\":170070.6215,\"z\":3.038}]\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/points.csv\n// module id = 28\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/index.scss\n// module id = 29\n// module chunks = 0"],"sourceRoot":""}